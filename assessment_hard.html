<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Python Assessment (Advanced) | Skillcheck</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body {
      background-color: #0c1220;
      color: #f0f0f0;
      font-family: "Poppins", sans-serif;
      margin: 0;
      padding: 0;
    }

    .navbar {
      background-color: #1c1f2b;
      padding: 1rem 2rem;
      text-align: center;
      font-size: 1.3rem;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .container {
      max-width: 900px;
      margin: 2rem auto;
      background-color: #1e2233;
      border-radius: 16px;
      padding: 2rem 2.5rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }

    h2 { color: #76b7c4; margin: 0 0 0.6rem 0; }

    .question-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom: .6rem; }
    .difficulty-tag { display:inline-block; padding:4px 8px; border-radius:8px; font-size:.85rem; }
    .hard-tag { background:#e74c3c; color:#fff; }

    .question-text { font-size: 1.2rem; color: #cfeef5; margin-bottom: 0.8rem; }

    .options { margin: 0; padding: 0; list-style: none; }
    .option {
      background: #2a2f44;
      padding: 0.8rem 1rem;
      border-radius: 10px;
      margin-bottom: 0.6rem;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
      transition: background .15s ease;
      user-select: none;
    }
    .option:hover { background: #3a4060; }
    .option.selected { background: #4a90e2; }

    .nav-buttons { display:flex; justify-content:space-between; margin-top:1rem; gap: 8px; }
    button {
      background-color: #4a4e69;
      color: #fff;
      border: none;
      border-radius: 10px;
      padding: 0.8rem 1.2rem;
      font-size: 1rem;
      cursor: pointer;
    }
    button:hover { transform: scale(1.03); }

    .question-nav { display:flex; gap:10px; flex-wrap:wrap; margin-top:1.2rem; justify-content:center; }
    .question-nav button { width: 36px; height: 36px; border-radius: 8px; background:#2a2f44; color:#fff; border: none; cursor:pointer;}
    .question-nav button.active { background:#4a90e2; }
    .question-nav button.answered { background:#16a085; }

    .result-section { display:none; text-align:center; padding-top: .6rem; }
  </style>
</head>
<body>
  <div class="navbar">üöÄ Python Assessment ‚Äì Advanced Level</div>

  <div class="container">
    <div id="quiz-section">
      <div class="question-meta">
        <h2 id="heading">Advanced Assessment</h2>
        <div>
          <span id="qIndex">1</span> / <span id="qTotal">10</span>
          <span id="diffTag" class="difficulty-tag hard-tag" style="margin-left:12px">Hard</span>
        </div>
      </div>

      <div id="question-area">
        <div id="question-text" class="question-text"></div>
        <ul id="options" class="options"></ul>

        <div class="nav-buttons">
          <button id="prevBtn">‚Üê Previous</button>
          <button id="nextBtn">Next ‚Üí</button>
        </div>

        <div id="questionNav" class="question-nav"></div>
      </div>
    </div>

    <div id="result-section" class="result-section">
      <h2>üéâ Assessment Completed!</h2>
      <p id="score-text"></p>
      <canvas id="resultChart" width="300" height="300"></canvas>
      <div style="margin-top:1rem;">
        <button onclick="window.location.href='main.html'">üè† Back to Dashboard</button>
        <button id="retryBtn">üîÅ Retry</button>
      </div>
    </div>
  </div>

<script>
const WEIGHT = 2;
const NUM_TO_PICK = 10;

const questionBank = [
  { q:"What is the output of list(map(lambda x: x**2, [1,2,3]))?", o:["[1,4,9]","[1,2,3]","[2,3,4]","Error"], a:0 },
  { q:"Which method is called when using len() on a custom class?", o:["__len__","__size__","__count__","__getlen__"], a:0 },
  { q:"What is the output: print(' '.join(['Python','Rocks']))", o:["Python Rocks","['Python','Rocks']","Error","PythonRocks"], a:0 },
  { q:"What will be output: print({i:i*i for i in range(3)})", o:["{0:0,1:1,2:4}","{0:1,1:2,2:3}","[0,1,2]","Error"], a:0 },
  { q:"Which keyword is used to define a coroutine?", o:["async","await","yield","co"], a:0 },
  { q:"Which function is used to iterate two lists together?", o:["zip()","map()","join()","enumerate()"], a:0 },
  { q:"What will be output: a=[1,2,3]; b=a; b[0]=99; print(a)", o:["[99,2,3]","[1,2,3]","Error","[99]"], a:0 },
  { q:"What is the output of 'abc'.encode()?", o:["b'abc'","'abc'","['a','b','c']","Error"], a:0 },
  { q:"What is the output: print(bool([]) == bool(()))", o:["True","False","None","Error"], a:0 },
  { q:"Which decorator is used to define a static method?", o:["@staticmethod","@classmethod","@property","@static"], a:0 },
  { q:"Which function in itertools repeats an element?", o:["repeat()","cycle()","count()","chain()"], a:0 },
  { q:"Which function serializes Python objects?", o:["pickle.dump()","json.save()","serialize()","marshal.dump()"], a:0 },
  { q:"What is the output of sorted(['apple','Banana','cherry'])?", o:["['Banana','apple','cherry']","['apple','Banana','cherry']","['cherry','Banana','apple']","Error"], a:0 },
  { q:"Which built-in function executes a string as code?", o:["exec()","eval()","run()","execute()"], a:0 },
  { q:"What is the output: print([x for x in range(5) if x%2==0])", o:["[0,2,4]","[1,3,5]","[2,4,6]","Error"], a:0 },
  { q:"Which of the following is True about Python memory management?", o:["Uses reference counting","No garbage collection","Manual memory allocation","Stack-based"], a:0 },
  { q:"What is a closure in Python?", o:["Function inside another function","Anonymous function","Decorator","Global variable"], a:0 },
  { q:"What is the output: print({1,2,3} & {2,3,4})", o:["{2,3}","{1,4}","{1,2,3,4}","Error"], a:0 },
  { q:"What is the output: print({1,2,3} | {2,3,4})", o:["{1,2,3,4}","{2,3}","{1,4}","Error"], a:0 },
  { q:"Which of these statements about 'with' is true?", o:["Automatically closes resources","Used for recursion","Used for generators","None"], a:0 },
  { q:"Which module supports multithreading?", o:["threading","asyncio","concurrent","multiprocessing"], a:0 },
  { q:"What is the output: sum(i*i for i in range(4))", o:["14","10","12","16"], a:0 },
  { q:"Which method copies object deeply?", o:["deepcopy()","copy()","clone()","replicate()"], a:0 },
  { q:"What is a lambda function?", o:["Anonymous function","Recursive function","Static method","Generator"], a:0 },
  { q:"Which of the following is not a Python data type?", o:["frozenset","bytearray","enum","stack"], a:3 },
  { q:"Which exception is raised by int('abc')?", o:["ValueError","TypeError","NameError","RuntimeError"], a:0 },
  { q:"Which module provides date/time utilities?", o:["datetime","calendar","time","os"], a:0 },
  { q:"Which function returns memory location?", o:["id()","hash()","ref()","mem()"], a:0 },
  { q:"What is the output: print([i for i in range(5) if i%2])", o:["[1,3]","[0,2,4]","[1,2,3,4]","Error"], a:0 },
  { q:"Which keyword is used for inheritance?", o:["class","extends","inherits","super"], a:0 },
  { q:"What is output of sorted({2,1,3})?", o:["[1,2,3]","{1,2,3}","Error","None"], a:0 },
  { q:"Which keyword is used in asynchronous code?", o:["await","async","yield","defer"], a:1 },
  { q:"What does 'is' compare?", o:["Object identity","Values","Types","Strings"], a:0 },
  { q:"Which method is used for class inheritance initialization?", o:["super()","init()","inherit()","cls()"], a:0 },
  { q:"Which module provides OS operations?", o:["os","sys","platform","file"], a:0 },
  { q:"What is the output: [i for i in 'Python' if i.isupper()]", o:["['P']","['y','t','h','o','n']","['P','Y']","Error"], a:0 },
  { q:"Which function can convert iterable to dictionary?", o:["dict()","map()","list()","tuple()"], a:0 },
  { q:"Which function gets attributes of object?", o:["dir()","vars()","get()","attr()"], a:0 },
  { q:"Which module handles JSON data?", o:["json","pickle","marshal","struct"], a:0 },
  { q:"Which keyword defines generator function?", o:["yield","gen","lambda","async"], a:0 },
  { q:"What will be output: print(any([0, '', False]))", o:["False","True","None","Error"], a:0 },
  { q:"Which built-in type is immutable?", o:["tuple","list","set","dict"], a:0 },
  { q:"What is output: all([1,2,0])?", o:["False","True","0","Error"], a:0 },
  { q:"Which function finds index of element in tuple?", o:["index()","find()","locate()","pos()"], a:0 },
  { q:"What is the output: print(divmod(7,3))", o:["(2,1)","2.3","7/3","Error"], a:0 },
  { q:"Which statement creates a virtual environment?", o:["python -m venv env","python venv","pip create venv","venv start"], a:0 },
  { q:"Which module provides mathematical constants?", o:["math","cmath","numbers","const"], a:0 },
  { q:"What does 'with open()' ensure?", o:["Automatic file close","Manual file close","No closing","None"], a:0 },
  { q:"Which exception is raised by 1/0?", o:["ZeroDivisionError","ValueError","ArithmeticError","OverflowError"], a:0 },
  { q:"What does @property decorator do?", o:["Defines getter method","Defines setter","Creates class","Defines variable"], a:0 },
  { q:"Which function applies to each item of iterable?", o:["map()","filter()","reduce()","zip()"], a:0 },
  { q:"Which module provides high-level file operations?", o:["shutil","os","sys","glob"], a:0 },
  { q:"Which function converts int to binary?", o:["bin()","binary()","hex()","oct()"], a:0 },
  { q:"What is output of hex(255)?", o:["0xff","255","0x255","Error"], a:0 },
  { q:"Which built-in function returns an iterator of pairs (index,value)?", o:["enumerate()","zip()","pairs()","items()"], a:0 },
  { q:"What is behavior of yield?", o:["Creates generator","Returns value immediately","Stops program","Defines function"], a:0 },
  { q:"Which data structure is hash-based?", o:["set","list","tuple","str"], a:0 },
  { q:"Which method removes an item by value?", o:["remove()","discard()","pop()","del"], a:0 },
  { q:"Which module implements regular expressions?", o:["re","regex","patterns","regexp"], a:0 },
  { q:"What does globals() return?", o:["Dictionary of global names","List of globals","None","Tuple of globals"], a:0 },
  { q:"Which statement handles exceptions?", o:["try/except","if/else","switch","for/else"], a:0 },
  { q:"Which built-in returns type of an object?", o:["type()","class()","instance()","typeof()"], a:0 },
  { q:"Which structure stores key/value pairs and is mutable?", o:["dict","tuple","list","set"], a:0 },
  { q:"Which module gives runtime info?", o:["sys","os","platform","runtime"], a:0 },
  { q:"Which built-in can convert iterable to list?", o:["list()","array()","iter()","collect()"], a:0 },
  { q:"Which function concatenates string list with separator?", o:["separator.join(list)","join(list)","concat(list)","'+'.join(list)"], a:0 },
  { q:"Which operator checks identity?", o:["is","==","!=","="], a:0 },
  { q:"Which builtin returns an immutable bytes object?", o:["bytes()","bytearray()","encode()","str()"], a:0 },
  { q:"Which module handles async?", o:["asyncio","threading","multiprocessing","concurrent"], a:0 }
];

let selectedQuestions = [];
let answers = [];
let currentIndex = 0;

const qTextEl = document.getElementById("question-text");
const optionsEl = document.getElementById("options");
const prevBtn = document.getElementById("prevBtn");
const nextBtn = document.getElementById("nextBtn");
const qIndexEl = document.getElementById("qIndex");
const qTotalEl = document.getElementById("qTotal");
const questionNav = document.getElementById("questionNav");
const quizSection = document.getElementById("quiz-section");
const resultSection = document.getElementById("result-section");
const scoreText = document.getElementById("score-text");
const retryBtn = document.getElementById("retryBtn");

function shuffle(a) {
  const arr = a.slice();
  for(let i=arr.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

function startQuiz() {
  selectedQuestions = shuffle(questionBank).slice(0, NUM_TO_PICK);
  answers = new Array(selectedQuestions.length).fill(null);
  currentIndex = 0;
  qTotalEl.textContent = selectedQuestions.length;
  buildNav();
  render(currentIndex);
}

function render(i) {
  const q = selectedQuestions[i];
  qIndexEl.textContent = i+1;
  qTextEl.textContent = `Q${i+1}. ${q.q}`;
  optionsEl.innerHTML = "";

  q.o.forEach((opt, idx) => {
    const li = document.createElement("li");
    li.className = "option" + (answers[i] === idx ? " selected" : "");
    li.innerHTML = opt;
    li.onclick = () => {
      answers[i] = idx;
      updateNav();
      render(i);
    };
    optionsEl.appendChild(li);
  });

  prevBtn.disabled = i === 0;
  nextBtn.textContent = i === selectedQuestions.length - 1 ? "Finish ‚Üí" : "Next ‚Üí";
  highlight(i);
}

function buildNav() {
  questionNav.innerHTML = "";
  for (let i = 0; i < selectedQuestions.length; i++) {
    const b = document.createElement("button");
    b.textContent = i + 1;
    b.onclick = () => {
      currentIndex = i;
      render(currentIndex);
    };
    questionNav.appendChild(b);
  }
  updateNav();
  highlight(currentIndex);
}

function updateNav() {
  const btns = document.querySelectorAll(".question-nav button");
  btns.forEach((b, i) => b.classList.toggle("answered", answers[i] !== null));
}

function highlight(i) {
  const btns = document.querySelectorAll(".question-nav button");
  btns.forEach((b, x) => b.classList.toggle("active", x === i));
}

function finish() {
  let correct = 0, earned = 0, total = 0;
  selectedQuestions.forEach((q, i) => {
    total += WEIGHT;
    if (answers[i] === q.a) {
      correct++;
      earned += WEIGHT;
    }
  });

  const percent = Math.round((earned / total) * 100);

  // ‚úÖ Store latest score (already exists)
  localStorage.setItem("pythonLatestScore", percent.toString());

// ‚úÖ Store history
  const attempt = {
    score: percent,
    level: "hard",  // change to "easy" or "hard" depending on page
    date: new Date().toLocaleString()
  };

let history = JSON.parse(localStorage.getItem("assessmentHistory")) || [];
history.push(attempt);
localStorage.setItem("assessmentHistory", JSON.stringify(history));

  localStorage.setItem("lastLevel", "Advanced (Python)");


  quizSection.style.display = "none";
  resultSection.style.display = "block";
  scoreText.textContent = `You scored ${percent}% ‚Äî Correct: ${correct}/${selectedQuestions.length}`;

  const ctx = document.getElementById("resultChart").getContext("2d");
  new Chart(ctx, {
    type: "pie",
    data: {
      labels: ["Correct", "Wrong"],
      datasets: [{
        data: [correct, selectedQuestions.length - correct],
        backgroundColor: ["#2ecc71", "#e74c3c"]
      }]
    },
    options: {
      plugins: {
        legend: {
          labels: { color: "#fff" }
        }
      }
    }
  });
}

prevBtn.onclick = () => { if (currentIndex > 0) { currentIndex--; render(currentIndex); } };
nextBtn.onclick = () => { if (currentIndex < selectedQuestions.length - 1) { currentIndex++; render(currentIndex); } else finish(); };
retryBtn.onclick = startQuiz;

startQuiz();
</script>

</body>
</html>
